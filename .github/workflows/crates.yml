name: crates
on: push
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v1
      - name: push-crates
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: |
          cargo doc --all --all-features --no-deps
          cd target/release
          mkdir tmp
          git init
          git remote add origin https://satellitex:${GITHUB_TOKEN}@github.com/staketechnologies/Plasm.git
          git checkout gh-pages
          cp -R ../doc/* .
          git add .
          git commit -m 'auto update crates on gh-pages'
          git push origin gh-pages
